import{d9 as Ce,s as Z,h as ee,f as Re,r as Ve,o as u,c as f,a as e,M as Y,at as he,X as R,Y as H,R as ne,T as re,Z as se,a2 as I,$ as L,al as $e,A as ie,B as ge,U as s,W as l,a0 as N,aj as z,V as p,aV as de,k as E,x as J,y as ce,fg as we,P as G,Q as P,t as B,w as X,aa as Ee,S as xe,z as ye,u as Ne,fk as _e,aZ as Ue,fl as Pe}from"./index.f074ecef.js";import{_ as We}from"./LoginPanel.33272c26.js";import{P as ze}from"./playAll.e1238004.js";import{_ as be}from"./FavoriteVideos.81cfbb94.js";import{_ as ke}from"./FolderMediaCard.1999fd20.js";import{_ as Se}from"./index.14a3ec94.js";import{d as Ge,I as Ae,ab as Ke,af as He}from"./MoreFeedback.eac5fca1.js";import{F as Ye}from"./FolderMediaCardSkeleton.2b4fce32.js";import{m as ve}from"./App.c1beb0e9.js";import{z as fe,H as me,B as pe,u as qe}from"./index.194c39d1.js";import{D as Ze}from"./vuedraggable.umd.b672350b.js";import{b as je,e as Qe,f as Xe}from"./mine.30873ffc.js";import{_ as Je}from"./OgvBangumiSkeleton.a1380a74.js";import"./SearchResultCount.6c930e27.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./ico_max_exit.f7f1ea61.js";import"./style.2070e26d.js";import"./btn_devtools.06ffa497.js";import"./index.733b73c2.js";import"./modulepreload-polyfill.b7f2da20.js";import"./isUdf.1a76b9f4.js";import"./ico_pin.a6faa7a5.js";/* empty css               */import"./theme-map.a3b52bba.js";function et(a){var _=[],i=function g(c){if(!c||typeof c!="object")return c;if(Ce(c))return c.map(function(r){return g(r)});if(_.indexOf(c)>-1)return c.constructor&&"[".concat(c.constructor.name,"]");_.push(c);var o={};return Object.keys(c).forEach(function(r){return o[r]=g(c[r])}),o};return i(a)}function tt(a,_,i){a=a||{},Ce(_)||(_=[]);var g={};return Object.keys(a).forEach(function(c){_.indexOf(c)===-1&&(g[c]=i?et(a[c]):a[c])}),g}const st=a=>{const _=`${Z.api}/x/v3/fav/folder/edit`;return ee.post(_,a)},ot=a=>{const _=`${Z.api}/x/v3/fav/folder/add`;return ee.post(_,a)},at=a=>{const _=`${Z.api}/x/v3/fav/folder/del`;return ee.post(_,{...a,platform:"web",jsonp:"jsonp"})},lt=a=>{const _=`${Z.api}/x/v3/fav/folder/sort`;return ee.post(_,a)},ut=a=>{const _=`${Z.api}/x/v3/fav/season/unfav`;return ee.post(_,{...a,platform:"web",jsonp:"jsonp"})},it=a=>{const _=`${Z.api}/x/v3/fav/folder/unfav`;return ee.post(_,{...a,jsonp:"jsonp"})},nt=a=>{const _=`${Z.api}/pgc/web/follow/del`;return Re.post(_,a).then(Ve)},rt={width:"16",height:"14",viewBox:"0 0 16 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},dt=e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M1.187 3.38C.287 2.276 1.072.624 2.495.624h11.01c1.423 0 2.207 1.652 1.308 2.754l-3.977 4.875a.938.938 0 0 0-.211.593v3.488a1.5 1.5 0 0 1-1.895 1.447l-2.111-.576a1.688 1.688 0 0 1-1.244-1.628V8.847a.938.938 0 0 0-.211-.593L1.187 3.38Zm1.308-1.63a.563.563 0 0 0-.436.918l3.977 4.875c.3.368.464.829.464 1.304v2.731c0 .254.17.476.415.543l2.111.576a.375.375 0 0 0 .474-.362V8.847c0-.475.164-.936.464-1.304l3.977-4.875a.563.563 0 0 0-.436-.918H2.495Z",fill:"#61666D"},null,-1),ct=[dt];function _t(a,_){return u(),f("svg",rt,[...ct])}var vt={render:_t};const ft={class:"tabs_frame"},mt={class:"tabs_frame--nav"},pt={class:"tabs_frame--content"},Ft=Y({__name:"TabsFrame",props:{activeKey:{type:[String,Number],default:0},tabKey:{type:String,default:""},tabs:{type:Array,default:()=>[]}},setup(a){const _=a;function i(g){return typeof g=="string"?g:g[_.tabKey||"key"]}return(g,c)=>(u(),f("div",ft,[e("div",mt,[he(g.$slots,"nav")]),e("div",pt,[(u(!0),f(R,null,H(a.tabs,o=>ne((u(),f("div",{key:i(o),class:"tabs_frame--pane"},[he(g.$slots,i(o))])),[[re,a.activeKey===i(o)]])),128))])]))}});const ht={class:"filter_buttons flex_row flex_wrap w_100"},gt=["onClick"],yt=e("span",{class:"gamepad-cursor","data-tp":"subTabs"},null,-1),bt=Y({__name:"FilterButtons",props:{activeKey:{type:[String,Number],default:0},list:{type:Array,default:()=>[]}},emits:["update:active-key"],setup(a,{emit:_}){const i=a;function g(c){c!==i.activeKey&&_("update:active-key",c)}return(c,o)=>(u(),f("div",ht,[(u(!0),f(R,null,H(a.list,r=>(u(),f("div",{key:r.key,class:se(["filter_buttons--item text_center cs_pointer p_relative",{"is-active":a.activeKey===r.key}]),onClick:y=>g(r.key)},[I(L(r.label)+" ",1),yt],10,gt))),128))]))}}),Dt={viewBox:"0 0 1024 1024"},Ct=e("path",{d:"M895.55 1022.801h-767.1c-29.866 5.394-58.532-14.383-63.926-44.248a54.288 54.288 0 0 1 0-19.677V512.8c-3.595-32.362 19.677-61.528 52.04-65.224 3.895-.399 7.89-.499 11.885-.1h63.926V255.7C192.375 89.495 332.01 0 512.999 0s318.626 83.902 318.626 255.7v191.776h63.926c64.524 0 63.925 20.875 63.925 63.925v447.475c6.292 29.066-12.186 57.633-41.152 63.925a54.686 54.686 0 0 1-22.773 0zm-511.4-191.775c0 70.617 57.233 127.85 127.85 127.85s127.85-57.233 127.85-127.85c-5.194-48.943-27.867-94.39-63.925-127.85v-127.85c0-35.259-28.666-63.925-63.925-63.925s-63.925 28.666-63.925 63.925v127.85c-36.058 33.46-58.731 78.907-63.925 127.85zM703.775 255.7c0-97.685-108.672-127.85-191.775-127.85S320.225 161.61 320.225 255.7v191.776h383.55V255.7zM513.298 0z",fill:"currentColor"},null,-1),$t=[Ct];function wt(a,_){return u(),f("svg",Dt,[...$t])}var Et={render:wt};const xt=["data-card"],kt={class:"favorite_card--cover"},St={class:"favorite_card--stats"},At={class:"favorite_card--stats--item left"},Bt={key:0,class:"favorite_card--stats--item"},Tt={class:"favorite_card--info"},It={class:"favorite_card--title flex_between"},Lt={class:"favorite_card--title-txt flex_start"},Mt={class:"p_relative w_lg h_lg"},Ot={class:"favorite_card--desc"},Be=Y({__name:"FavoriteCard",props:{isFirstCard:{type:Boolean,default:!1},data:{type:Object,default:()=>({})},cardType:{type:String,default:"folders"}},emits:["submitAction"],setup(a,{emit:_}){const{data:i,cardType:g}=a,c=$e(),o=ie(()=>i.type===21),r=ie(()=>o.value?i.play_switch?i.view_text_1?`${i.view_text_1}\u64AD\u653E`:`${ge(i.view_count||0)}\u64AD\u653E`:`${ge(i.view_count||0)}\u64AD\u653E`:`\u521B\u5EFA\u4E8E${Ge("YYYY-MM-DD",i.ctime*1e3)}`),y=ie(()=>o.value?"\u5408\u96C6":""),b=ie(()=>o.value?`${i.media_count||0}\u4E2A\u5185\u5BB9`:`${i.media_count||0}\u4E2A\u5185\u5BB9\xB7${(i.attr>>0&1)===0?"\u516C\u5F00":"\u79C1\u5BC6"}`);function x(){c.push({name:"Favorite",query:{type:o.value?"season":"folder",id:i.id}})}let k=[];switch(g){case"folders":k=[{type:"EDIT",label:"\u7F16\u8F91\u4FE1\u606F"},{type:"DELETE",label:"\u5220\u9664\u6536\u85CF\u5939"}];break;case"seasons":k=[{type:"DELETE",label:"\u53D6\u6D88\u8BA2\u9605"}];break;case"spaceSeasons":k=[];break}function M({type:U}){_("submitAction",{type:U,data:i})}return(U,h)=>(u(),f("div",{class:"favorite_card",onClick:x},[e("span",{class:"gamepad-cursor cursor-video-card","data-scroll":"y","data-bf":"100","data-sh":"300","data-wp":".app_mine--content","data-tp":"videoCard","data-card":a.isFirstCard},null,8,xt),e("div",kt,[s(ke,{src:a.data.cover,width:227},null,8,["src"]),e("div",St,[e("div",At,L(l(b)),1),l(y)?(u(),f("div",Bt,L(l(y)),1)):N("",!0)])]),e("div",Tt,[e("div",It,[e("div",Lt,[a.data.isPrivate?(u(),z(l(Et),{key:0})):N("",!0),e("span",null,L(a.data.title),1)]),e("div",Mt,[l(k).length?(u(),z(Se,{key:0,class:"favorite_video_card--more",items:l(k),onSelect:M},{default:p(()=>[s(l(Ae),{class:"favorite_video_card--more--btn"})]),_:1},8,["items"])):N("",!0)])]),e("div",Ot,L(l(r)),1)])]))}});const Rt={class:"favorite_card_skeleton"},Vt={class:"favorite_card_skeleton--cover"},Nt=e("div",{class:"favorite_card_skeleton--info"},[e("div",{class:"favorite_card_skeleton--title"}),e("div",{class:"favorite_card_skeleton--desc"})],-1),Te=Y({__name:"FavoriteCardSkeleton",setup(a){return(_,i)=>(u(),f("div",Rt,[e("div",Vt,[s(Ye,{class:"mb_xxl",width:227})]),Nt]))}});const Ut={class:"favorite_folders i_wrapper p_relative pt_sm"},Pt={key:2,class:"favorite_folders--loading row gutter_md"},Wt={class:"row gutter_md"},zt=e("p",{class:"b_text text2 mt_nsm mb_md text_center text_ellipsis"},"\u62D6\u52A8\u6536\u85CF\u5939\u8FDB\u884C\u6392\u5E8F",-1),Gt={class:"content-wrapper"},Kt={class:"collection_dir--item p_relative"},Ht={class:"collection_dir--item-tt p_center_x b_n2 fs_6 text_ellipsis"},Yt={class:"mt_xl text_center dialog_btns"},qt=I("\u53D6\u6D88"),Zt=I("\u786E\u5B9A"),jt={class:"content-wrapper"},Qt={class:"mt_sm text_left"},Xt={class:"mt_xl text_center dialog_btns"},Jt=I("\u53D6\u6D88"),es=I("\u786E\u5B9A"),ts={class:"content-wrapper"},ss={class:"mt_sm text_left"},os={class:"mt_xl text_center dialog_btns"},as=I("\u53D6\u6D88"),ls=I("\u786E\u5B9A"),us={class:"content-wrapper"},is=e("h4",{class:"b_text text1 text_center mt_md"},"\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684\u6536\u85CF\u5939\u5417\uFF1F",-1),ns={class:"b_text text2 mt_sm text_center text_ellipsis"},rs=I(" \u6536\u85CF\u5939\uFF1A"),ds=["title"],cs={class:"mt_xl text_center dialog_btns"},_s=I("\u624B\u6ED1\u4E86"),vs=I("\u786E\u5B9A\u5220\u9664"),fs=Y({__name:"FavoriteFolders",props:{isActive:Boolean},emits:["update-default-folder-id"],setup(a,{expose:_,emit:i}){const g=de(),c=E(!1),o=E(!1),r=E(!1),y=E(!1),b=E(!1),x=E(),k=E(!0),{userInfo:M}=J(ce()),{isFavFolderChanged:U,isOnLoadingFolders:h,isFoldersLoadError:T}=J(we()),{status:v,list:C,reset:q}=fe([]),S=E([]),V=E(""),w=E({title:"",public:!0,media_id:0}),F=E({title:"",public:!0});let m=1;G(C,()=>g.flashPageCursors(200),{deep:!0});function D(){m=1,C.value=[],q(),A()}async function A(){var n;if(!(v.value==="loading"||v.value==="noMore")){v.value="loading",h.value=!0,T.value=!1;try{const t=await je(M.value.mid,m);if((n=t.list)!=null&&n.length){if(m===1){t.list.forEach(d=>d.isPrivate=j(d.attr,0));const{id:O,media_count:Q,title:le}=t.list[0];V.value=O,i("update-default-folder-id",{id:O,count:Q,title:le}),t.list.shift()}const $=t.list.filter(O=>[V.value,...C.value].every(Q=>Q.id!==O.id));C.value.push(...$)}C.value.length?t.has_more?v.value="loaded":v.value="noMore":v.value="empty",U.value=!1,h.value=!1}catch{v.value="error",h.value=!1,T.value=!0}}}const K=({type:n,data:t})=>{x.value=t,w.value={title:t.title,public:!t.isPrivate,media_id:t.id},n==="EDIT"?o.value=!0:n==="DELETE"&&(y.value=!0)};function j(n,t){const $=+n.toString(2);return parseInt(("000000"+$).substr(-7).split("").reverse().join("").charAt(t))}const oe=()=>{o.value=!1,st({...w.value,privacy:+!w.value.public}).then(n=>{const{code:t,message:$}=n;if(t!==0){B({content:$||"\u7F16\u8F91\u6536\u85CF\u5939\u5931\u8D25\uFF01"});return}setTimeout(()=>D(),500),B({content:"\u7F16\u8F91\u6536\u85CF\u5939\u6210\u529F\uFF01"})}).catch(n=>{console.error(n),B({content:"\u7F16\u8F91\u6536\u85CF\u5939\u5931\u8D25\uFF01"})})},ae=n=>{n.item.classList.add("invisible")},W=n=>{n.item.classList.remove("invisible");const t=C.value.map(O=>O.id).join(","),$=S.value.map(O=>O.id).join(",");k.value=$===t,b.value=!1},te=()=>{y.value=!1,at({media_ids:x.value.id}).then(n=>{const{code:t,message:$}=n;if(t!==0){B({content:$||"\u5220\u9664\u6536\u85CF\u5939\u5931\u8D25\uFF01"});return}setTimeout(()=>D(),500),B({content:"\u5220\u9664\u6536\u85CF\u5939\u6210\u529F\uFF01"})}).catch(n=>{console.error(n),B({content:"\u5220\u9664\u6536\u85CF\u5939\u5931\u8D25\uFF01"})})},Fe=()=>{c.value=!0,F.value={title:"",public:!0}},Ie=()=>{c.value=!1,ot({...F.value,privacy:+!F.value.public}).then(n=>{const{code:t,message:$}=n;if(console.log(n),t!==0){B({content:$||"\u65B0\u5EFA\u6536\u85CF\u5939\u5931\u8D25\uFF01"});return}setTimeout(()=>D(),500),B({content:"\u65B0\u5EFA\u6536\u85CF\u5939\u6210\u529F\uFF01"})}).catch(n=>{console.error(n),B({content:"\u65B0\u5EFA\u6536\u85CF\u5939\u5931\u8D25\uFF01"})})},Le=()=>{S.value=[...C.value],k.value=!0,r.value=!0},Me=()=>{r.value=!1,lt({sort:`${V.value},${S.value.map(n=>n.id).join(",")}`}).then(n=>{const{code:t,message:$}=n;if(t!==0){B({content:$||"\u6536\u85CF\u5939\u6392\u5E8F\u5931\u8D25\uFF01"});return}setTimeout(()=>D(),500),B({content:"\u6536\u85CF\u5939\u6392\u5E8F\u6210\u529F\uFF01"})}).catch(n=>{console.error(n),B({content:"\u6536\u85CF\u5939\u6392\u5E8F\u5931\u8D25\uFF01"})})};_({list:C,reload:()=>{U.value&&D()},handleCreateFolder:Fe,handleSortFavFolder:Le}),G(()=>w.value.title,n=>{n.length>20&&X(()=>w.value.title=n.substr(0,20))}),G(()=>F.value.title,n=>{n.length>20&&X(()=>F.value.title=n.substr(0,20))}),G(M,n=>{!(n!=null&&n.mid)||C.value.length||A()},{immediate:!0});function Oe(){v.value==="error"||v.value==="empty"||v.value==="noMore"||(++m,A())}return(n,t)=>{const $=P("v-button"),O=P("v-dialog"),Q=P("v-input"),le=P("v-checkbox");return u(),f("div",Ut,[l(C).length?a.isActive?(u(),f(R,{key:1},[e("div",Wt,[(u(!0),f(R,null,H(l(C),(d,ue)=>(u(),f("div",{class:"favorite_folders--card col_3 col_sm_1_5 mb_xxl",key:d.aid},[s(Be,{data:d,isFirstCard:ue===0,cardType:"folders",onSubmitAction:K},null,8,["data","isFirstCard"])]))),128))]),s(pe,{onTrigger:Oe})],64)):N("",!0):(u(),f(R,{key:0},[l(v)==="error"?(u(),z(me,{key:0,showRefresh:!1,text:"\u54CE\u5440\uFF01\u597D\u50CF\u52A0\u8F7D\u5931\u8D25\u4E86>.<"})):l(v)==="empty"?(u(),z(ve,{key:1,"is-small":""})):l(v)==="loading"?(u(),f("div",Pt,[(u(),f(R,null,H(20,d=>e("div",{class:"favorite_folders--card col_3 col_sm_1_5 mb_xxl",key:d},[s(Te,{data:d},null,8,["data"])])),64))])):N("",!0)],64)),s(O,{visible:r.value,"onUpdate:visible":t[3]||(t[3]=d=>r.value=d),width:580,"class-name":"i_dialog py_lg",title:"\u6536\u85CF\u5939\u6392\u5E8F",center:!0,"is-show-default-footer":!1,onCancel:t[4]||(t[4]=d=>r.value=!1)},{default:p(()=>[zt,e("div",Gt,[e("div",{class:se(["sort_collection_dir",{sorting:b.value}])},[s(l(Ze),{list:S.value,class:"collection_dir",draggable:".collection_dir--item",animation:"500","item-key":"id",onMousedown:t[0]||(t[0]=d=>b.value=!0),onMouseup:t[1]||(t[1]=d=>b.value=!1),onStart:ae,onEnd:W},{item:p(({element:d})=>[e("div",Kt,[s(ke,{src:d.cover,width:227},null,8,["src"]),e("h6",Ht,L(d.title),1)])]),_:1},8,["list"])],2),e("div",Yt,[s($,{class:"mr_sm",onClick:t[2]||(t[2]=d=>r.value=!1)},{default:p(()=>[qt]),_:1}),s($,{type:"pink",onClick:Me,disabled:k.value},{default:p(()=>[Zt]),_:1},8,["disabled"])])])]),_:1},8,["visible"]),s(O,{visible:c.value,"onUpdate:visible":t[8]||(t[8]=d=>c.value=d),width:380,"class-name":"i_dialog py_lg",title:"\u65B0\u5EFA\u6536\u85CF\u5939",center:!0,"is-show-default-footer":!1,onCancel:t[9]||(t[9]=d=>c.value=!1)},{default:p(()=>[e("div",jt,[e("div",null,[s(Q,{placeholder:"\u6536\u85CF\u5939\u540D\u79F0\uFF08\u4E0D\u8D85\u8FC720\u4E2A\u5B57\uFF09",modelValue:F.value.title,"onUpdate:modelValue":t[5]||(t[5]=d=>F.value.title=d)},null,8,["modelValue"])]),e("div",Qt,[s(le,{label:"\u516C\u5F00\u6536\u85CF\u5939",theme:"pink",modelValue:F.value.public,"onUpdate:modelValue":t[6]||(t[6]=d=>F.value.public=d)},null,8,["modelValue"])]),e("div",Xt,[s($,{class:"mr_sm",onClick:t[7]||(t[7]=d=>c.value=!1)},{default:p(()=>[Jt]),_:1}),s($,{type:"pink",onClick:Ie},{default:p(()=>[es]),_:1})])])]),_:1},8,["visible"]),s(O,{visible:o.value,"onUpdate:visible":t[13]||(t[13]=d=>o.value=d),width:380,"class-name":"i_dialog py_lg",title:"\u7F16\u8F91\u4FE1\u606F",center:!0,"is-show-default-footer":!1,onCancel:t[14]||(t[14]=d=>o.value=!1)},{default:p(()=>[e("div",ts,[e("div",null,[s(Q,{placeholder:"\u6536\u85CF\u5939\u540D\u79F0\uFF08\u4E0D\u8D85\u8FC720\u4E2A\u5B57\uFF09",modelValue:w.value.title,"onUpdate:modelValue":t[10]||(t[10]=d=>w.value.title=d)},null,8,["modelValue"])]),e("div",ss,[s(le,{label:"\u516C\u5F00\u6536\u85CF\u5939",theme:"pink",modelValue:w.value.public,"onUpdate:modelValue":t[11]||(t[11]=d=>w.value.public=d)},null,8,["modelValue"])]),e("div",os,[s($,{class:"mr_sm",onClick:t[12]||(t[12]=d=>o.value=!1)},{default:p(()=>[as]),_:1}),s($,{type:"pink",onClick:oe},{default:p(()=>[ls]),_:1})])])]),_:1},8,["visible"]),s(O,{visible:y.value,"onUpdate:visible":t[16]||(t[16]=d=>y.value=d),width:320,"class-name":"i_dialog py_lg",onCancel:t[17]||(t[17]=d=>y.value=!1),"is-show-default-footer":!1},{default:p(()=>{var d,ue;return[e("div",us,[is,e("p",ns,[rs,e("strong",{title:(d=x.value)==null?void 0:d.title},L((ue=x.value)==null?void 0:ue.title),9,ds)]),e("div",cs,[s($,{class:"mr_sm",onClick:t[15]||(t[15]=Qs=>y.value=!1)},{default:p(()=>[_s]),_:1}),s($,{type:"pink",onClick:te},{default:p(()=>[vs]),_:1})])])]}),_:1},8,["visible"])])}}}),ms={class:"favorite_seasons i_wrapper p_relative pt_sm"},ps={key:0,class:"favorite_seasons--loading row gutter_md"},Fs={class:"row gutter_md"},hs={class:"content-wrapper"},gs=e("h4",{class:"b_text text1 text_center mt_md"},"\u786E\u5B9A\u9700\u8981\u53D6\u6D88\u8BE5\u6536\u85CF\u6216\u5408\u96C6\u5417\uFF1F",-1),ys={class:"b_text text2 mt_sm text_center text_ellipsis"},bs=I(" \u540D\u79F0\uFF1A"),Ds=["title"],Cs={class:"mt_xl text_center dialog_btns"},$s=I("\u624B\u6ED1\u4E86"),ws=I("\u53D6\u6D88\u8BA2\u9605"),Es=Y({__name:"FavoriteSeasons",props:{isActive:Boolean},setup(a){const _=de(),i=E(!1),g=E(),{userInfo:c}=J(ce()),{status:o,list:r,reset:y}=fe([]);let b=1;G(r,()=>_.flashPageCursors(200),{deep:!0});function x(){b=1,r.value=[],y(),k()}async function k(){var T;if(!(o.value==="loading"||o.value==="noMore")){o.value="loading";try{const v=await Qe(c.value.mid,b);(T=v.list)!=null&&T.length&&r.value.push(...v.list),r.value.length?v.has_more?o.value="loaded":o.value="noMore":o.value="empty"}catch{o.value="error"}}}const M=({type:T,data:v})=>{g.value=v,T==="DELETE"&&(i.value=!0)},U=()=>{i.value=!1;const{type:T,id:v}=g.value;T===11?it({media_id:v}).then(C=>{if(C.code!==0){B({content:C.message||"\u53D6\u6D88\u8BA2\u9605\u5931\u8D25\uFF01"});return}setTimeout(()=>x(),500),B({content:"\u53D6\u6D88\u8BA2\u9605\u6210\u529F\uFF01"})}).catch(()=>{B({content:"\u53D6\u6D88\u8BA2\u9605\u5931\u8D25\uFF01"})}):ut({season_id:v}).then(C=>{if(C.code!==0){B({content:C.message||"\u53D6\u6D88\u8BA2\u9605\u5931\u8D25\uFF01"});return}setTimeout(()=>x(),500),B({content:"\u53D6\u6D88\u8BA2\u9605\u6210\u529F\uFF01"})}).catch(()=>{B({content:"\u53D6\u6D88\u8BA2\u9605\u5931\u8D25\uFF01"})})};G(c,T=>{!(T!=null&&T.mid)||r.value.length||k()},{immediate:!0});function h(){o.value==="error"||o.value==="empty"||o.value==="noMore"||(++b,k())}return(T,v)=>{const C=P("v-button"),q=P("v-dialog");return u(),f("div",ms,[!l(r).length&&l(o)==="error"?(u(),z(me,{key:0,showRefresh:!1,text:"\u54CE\u5440\uFF01\u597D\u50CF\u52A0\u8F7D\u5931\u8D25\u4E86>.<"})):N("",!0),!l(r).length&&l(o)!=="error"?(u(),f(R,{key:1},[l(o)==="loading"?(u(),f("div",ps,[(u(),f(R,null,H(20,S=>e("div",{class:"favorite_seasons--card col_3 col_sm_1_5 mb_xxl",key:S},[s(Te,{data:S},null,8,["data"])])),64))])):l(o)==="empty"?(u(),z(ve,{key:1,"is-small":""})):N("",!0)],64)):a.isActive?(u(),f(R,{key:2},[e("div",Fs,[(u(!0),f(R,null,H(l(r),(S,V)=>(u(),f("div",{class:"favorite_seasons--card col_3 col_sm_1_5 mb_xxl",key:S.aid},[s(Be,{data:S,isFirstCard:V===0,cardType:"seasons",onSubmitAction:M},null,8,["data","isFirstCard"])]))),128))]),s(pe,{onTrigger:h})],64)):N("",!0),s(q,{visible:i.value,"onUpdate:visible":v[1]||(v[1]=S=>i.value=S),width:320,"class-name":"i_dialog py_lg",onCancel:v[2]||(v[2]=S=>i.value=!1),"is-show-default-footer":!1},{default:p(()=>{var S,V;return[e("div",hs,[gs,e("p",ys,[bs,e("strong",{title:(S=g.value)==null?void 0:S.title},L((V=g.value)==null?void 0:V.title),9,Ds)]),e("div",Cs,[s(C,{class:"mr_sm",onClick:v[0]||(v[0]=w=>i.value=!1)},{default:p(()=>[$s]),_:1}),s(C,{type:"danger",onClick:U},{default:p(()=>[ws]),_:1})])])]}),_:1},8,["visible"])])}}}),xs={key:0,class:"favorite_ogv_list--loading i_wrapper mt_sm"},ks={key:2,class:"favorite_ogv_list pt_sm i_wrapper p_relative"},Ss={class:"row gutter_md"},As=e("div",{class:"favorite_ogv_list--card--more"},null,-1),Bs={class:"content-wrapper"},Ts={class:"b_text text1 text_center mt_md"},Is={class:"b_text text2 mt_sm text_center text_ellipsis"},Ls=["title"],Ms={class:"mt_xl text_center dialog_btns"},Os=I("\u624B\u6ED1\u4E86"),De=Y({__name:"FavoriteOgvList",props:{isActive:Boolean,type:{type:Number,default:1},followStatus:{type:Number,default:0}},setup(a,{expose:_}){const i=a,g=de(),{userInfo:c}=J(ce()),{status:o,list:r,reset:y}=fe([]),b=E([]),x=E(!1),k=E();let M=1;G(r,()=>g.flashPageCursors(200),{deep:!0});function U(){M=1,r.value=[],b.value=[],y()}async function h(){var w;if(!(o.value==="loading"||o.value==="noMore"||!i.type)){o.value="loading";try{const F=await Xe(c.value.mid,i.type,i.followStatus,M),m=F.total>F.ps*F.pn;(w=F.list)!=null&&w.length&&(b.value.push(...F.list),r.value.push(...F.list.map(He))),r.value.length?m?o.value="loaded":o.value="noMore":o.value="empty"}catch{o.value="error"}}}function T(){o.value==="error"||o.value==="empty"||o.value==="noMore"||(++M,h())}function v(){U(),h()}function C(w){Ee({type:"ogv",seasonId:w.sid,fromSpmid:`${xe.mineFavorite}.pv`})}_({refresh:v});const q=[{type:"REMOVE",label:i.type===1?"\u53D6\u6D88\u8FFD\u756A":"\u53D6\u6D88\u8FFD\u5267"}],S=(w,F)=>{w.type==="REMOVE"&&(x.value=!0,k.value=F)},V=()=>{x.value=!1;const w=b.value.find(D=>D.season_id===k.value.sid),{season_id:F,season_type:m}=w;nt({season_id:F,season_type:m}).then(()=>{setTimeout(()=>v(),500),B({content:i.type===1?"\u53D6\u6D88\u8FFD\u756A\u6210\u529F\uFF01":"\u53D6\u6D88\u8FFD\u5267\u6210\u529F\uFF01"})}).catch(D=>{console.error(D),B({content:i.type===1?"\u53D6\u6D88\u8FFD\u756A\u5931\u8D25\uFF01":"\u53D6\u6D88\u8FFD\u5267\u5931\u8D25\uFF01"})})};return(w,F)=>{const m=P("v-button"),D=P("v-dialog");return u(),f("div",null,[!l(r).length&&l(o)==="error"?(u(),z(me,{key:0,class:"mt_sm",showRefresh:!1,text:"\u54CE\u5440\uFF01\u597D\u50CF\u52A0\u8F7D\u5931\u8D25\u4E86>.<"})):N("",!0),!l(r).length&&l(o)!=="error"?(u(),f(R,{key:1},[l(o)==="loading"?(u(),f("div",xs,[s(Je)])):l(o)==="empty"?(u(),z(ve,{key:1,class:"mt_sm","is-small":""})):N("",!0)],64)):a.isActive?(u(),f("div",ks,[e("div",Ss,[(u(!0),f(R,null,H(l(r),(A,K)=>(u(),f("div",{class:"favorite_ogv_list--card col_2 col_sm_1_7 mb_xxl",key:A.bvid},[s(l(Ke),{onClickBangumi:C,info:A,mode:"vertical","img-lazy":"eager","disable-frame":"","disable-scale":"","disable-inline-player":"","disable-hover":"",isFirstCard:K===0,scrollWrap:".app_mine--content"},{more:p(()=>[e("div",null,[s(Se,{class:"favorite_video_card--more",items:q,onSelect:j=>S(j,A)},{default:p(()=>[s(l(Ae),{class:"favorite_video_card--more--btn"})]),_:2},1032,["onSelect"])])]),_:2},1032,["info","isFirstCard"]),As]))),128))]),l(r).length?(u(),z(pe,{key:0,onTrigger:T})):N("",!0),s(D,{visible:x.value,"onUpdate:visible":F[1]||(F[1]=A=>x.value=A),width:320,"class-name":"i_dialog py_lg",onCancel:F[2]||(F[2]=A=>x.value=!1),"is-show-default-footer":!1},{default:p(()=>{var A,K;return[e("div",Bs,[e("h4",Ts,"\u786E\u5B9A\u9700\u8981\u53D6\u6D88\u8BE5\u8FFD"+L(a.type===1?"\u756A":"\u5267")+"\u5417\uFF1F",1),e("p",Is,[I(L(a.type===1?"\u756A\u540D":"\u5267\u540D")+"\uFF1A",1),e("strong",{title:(A=k.value)==null?void 0:A.title},L((K=k.value)==null?void 0:K.title),9,Ls)]),e("div",Ms,[s(m,{class:"mr_sm",onClick:F[0]||(F[0]=j=>x.value=!1)},{default:p(()=>[Os]),_:1}),s(m,{type:"danger",onClick:V},{default:p(()=>[I("\u53D6\u6D88\u8FFD"+L(a.type===1?"\u756A":"\u5267"),1)]),_:1})])])]}),_:1},8,["visible"])])):N("",!0)])}}});const Rs={key:0,class:"mine_favorite--unlogin flex_col_center w_100 h_100"},Vs={key:1,class:"mine_favorite"},Ns={class:"mine_favorite--header flex_between i_wrapper"},Us={class:"mine_favorite--header--right p_relative"},Ps=e("span",null,"\u64AD\u653E\u5168\u90E8",-1),Ws=e("span",{class:"gamepad-cursor"},null,-1),zs={class:"mine_favorite--header--right flex_start"},Gs=e("span",{class:"fs_2 mr_xs"},"+",-1),Ks=I(" \u65B0\u5EFA\u6536\u85CF\u5939 "),Hs=e("span",null,"\u6536\u85CF\u5939\u6392\u5E8F",-1),Ys={class:"mine_favorite--header--right"},qs={class:se({"favorite_dropdown_select--content":!0})},Zs=["onClick","textContent"],js={key:1,class:"favorite_search_panel"},Co=Y({__name:"MineFavorite",setup(a,{expose:_}){var F;const i=E(null),g=E(null),c=E(null),o=E(null),r=E(!1),y=ye({visible:!1,options:[],index:0}),b=ye({video:{defaultFolderId:0,defaultFolderLength:0,defaultFolderName:"\u9ED8\u8BA4\u6536\u85CF\u5939"},followSeries:{followStatus:0},bingeWatching:{followStatus:0}}),x=Ne(),k=$e(),{userInfo:M}=J(ce()),U=de();qe({spm_id:xe.mineFavorite,isKeepAlive:!1,pageName:"MineFavorite"});const{mineFavoriteTab:h}=J(we()),T=(F=x.query)==null?void 0:F.tab;if(T){const m=_e.find(D=>D.key===T);m&&(h.value=m.key,k.replace({path:x.path,query:tt(x.query,["tab"])}))}G(h,()=>U.flashPageCursors(200)),G(h,async()=>{["FOLLOW_SERIES","BINGE_WATCHING"].includes(h.value)?y.options=Pe:y.options=[],v(0)},{immediate:!0});async function v(m){y.index=m,h.value==="CUSTOM_FOLDERS"?(await X(),i.value.reload()):h.value==="FOLLOW_SERIES"?(b.followSeries.followStatus=y.options[m].value,await X(),g.value.refresh()):h.value==="BINGE_WATCHING"&&(b.bingeWatching.followStatus=y.options[m].value,await X(),c.value.refresh())}function C({id:m,count:D,title:A}){b.video.defaultFolderId=m,b.video.defaultFolderLength=D,b.video.defaultFolderName=A}const q=()=>{const m=b.video.defaultFolderId;!m||!b.video.defaultFolderLength||Ee({type:"ugc",fromSpmid:"main.mine-collection.0.0.pv",mediaList:{bizType:3,bizId:m.toString(),bizTitle:b.video.defaultFolderName}})},S=()=>{var m;(m=i.value)==null||m.handleCreateFolder()},V=()=>{var m;(m=i.value)==null||m.handleSortFavFolder()};return _({doSearch:async m=>{var D;r.value=!!m,await X(),m&&((D=o.value)==null||D.doSearch(m))}}),(m,D)=>{const A=P("v-button"),K=P("WidgetArrow"),j=P("VDropdown");return!l(M)||!l(M).isLogin?(u(),f("div",Rs,[s(We,{showAvatar:""})])):(u(),f("div",Vs,[r.value?(u(),f("div",js,[s(be,{ref_key:"favoriteVideoRef",ref:o,isSearchPage:!0,id:b.video.defaultFolderId,owner:"",isActive:!0,searchMode:l(h)==="DEFAULT_FOLDER"?"currentFolder":"allFolder"},null,8,["id","searchMode"])])):(u(),z(Ft,{key:0,tabs:l(_e),"active-key":l(h)},{nav:p(()=>{var oe,ae;return[e("div",Ns,[s(bt,{class:"mine_favorite--header--left",list:l(_e),"active-key":l(h),"onUpdate:active-key":D[0]||(D[0]=W=>Ue(h)?h.value=W:null)},null,8,["list","active-key"]),ne(e("div",Us,[s(A,{disabled:!b.video.defaultFolderLength,class:"right-btn",type:"pink",onClick:q},{default:p(()=>[s(l(ze)),Ps,Ws]),_:1},8,["disabled"])],512),[[re,l(h)==="DEFAULT_FOLDER"]]),ne(e("div",zs,[s(A,{class:"right-btn mr_sm text2",onClick:S},{default:p(()=>[Gs,Ks]),_:1}),s(A,{disabled:!((ae=(oe=i.value)==null?void 0:oe.list)!=null&&ae.length),class:"right-btn text2",onClick:V},{default:p(()=>[s(l(vt)),Hs]),_:1},8,["disabled"])],512),[[re,l(h)==="CUSTOM_FOLDERS"]]),ne(e("div",Ys,[s(j,{classname:"favorite_dropdown_select",trigger:"hover",placement:"bottom-end",onShow:D[1]||(D[1]=W=>y.visible=!0),onHide:D[2]||(D[2]=W=>y.visible=!1)},{content:p(()=>[e("div",qs,[(u(!0),f(R,null,H(y.options,(W,te)=>(u(),f("div",{class:se(["favorite_dropdown_select--content--item cs_pointer",{"is-active":te===y.index}]),key:te,onClick:Fe=>v(te),textContent:L(W.label)},null,10,Zs))),128))])]),default:p(()=>[s(A,{class:"favorite_dropdown_select--button p_relative fs_14 text_ellipsis"},{default:p(()=>{var W;return[I(L((W=y.options[y.index])==null?void 0:W.label)+" ",1),s(K,{class:se(["favorite_dropdown_select--button--icon rotate_90 p_absolute",{rotate_deg:y.visible}])},null,8,["class"])]}),_:1})]),_:1})],512),[[re,y.options.length]])])]}),DEFAULT_FOLDER:p(()=>[s(be,{isActive:l(h)==="DEFAULT_FOLDER",id:b.video.defaultFolderId,owner:"",isDefault:!0},null,8,["isActive","id"])]),CUSTOM_FOLDERS:p(()=>[s(fs,{isActive:l(h)==="CUSTOM_FOLDERS",onUpdateDefaultFolderId:C,ref_key:"favoriteFolders",ref:i},null,8,["isActive"])]),COLLECTION:p(()=>[s(Es,{isActive:l(h)==="COLLECTION"},null,8,["isActive"])]),FOLLOW_SERIES:p(()=>[s(De,{isActive:l(h)==="FOLLOW_SERIES",type:1,"follow-status":b.followSeries.followStatus,ref_key:"followSeriesRef",ref:g},null,8,["isActive","follow-status"])]),BINGE_WATCHING:p(()=>[s(De,{isActive:l(h)==="BINGE_WATCHING",type:2,"follow-status":b.bingeWatching.followStatus,ref_key:"bingeWatchingRef",ref:c},null,8,["isActive","follow-status"])]),_:1},8,["tabs","active-key"]))]))}}});export{Co as default};

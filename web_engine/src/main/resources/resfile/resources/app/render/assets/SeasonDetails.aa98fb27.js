import{k as j,s as G,m as U,N as H}from"./App.c1beb0e9.js";import{P as O}from"./playAll.e1238004.js";import{_ as Q}from"./FolderMediaCard.1999fd20.js";import{F as X}from"./FolderMediaCardSkeleton.2b4fce32.js";import{M as Y,aV as J,k as m,u as K,al as Z,A as S,P as ee,l as ae,Q as C,o as t,c,U as p,V as D,a as d,W as _,aj as b,$ as k,X as w,Y as z,a0 as se,a2 as te,aa as oe,dE as le,g as A}from"./index.f074ecef.js";import{am as B}from"./MoreFeedback.eac5fca1.js";import{f as re,h as ne,i as ie}from"./space.a51500ef.js";import{L as E}from"./index.194c39d1.js";import"./btn_devtools.06ffa497.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./index.733b73c2.js";import"./style.2070e26d.js";import"./modulepreload-polyfill.b7f2da20.js";import"./ico_max_exit.f7f1ea61.js";import"./index.14a3ec94.js";import"./isUdf.1a76b9f4.js";import"./ico_pin.a6faa7a5.js";/* empty css               */import"./theme-map.a3b52bba.js";const ce={class:"season_details h_100"},ue={class:"i_wrapper mt_xxl"},me={class:"season_details--header flex_start items_start"},_e={class:"season_details--header-info"},de={class:"b_text mt_xs text_ellipsis"},pe={class:"b_text text3 fs_5"},ve=te(" \u64AD\u653E\u5168\u90E8 "),fe=d("span",{class:"gamepad-cursor"},null,-1),he={class:"season_details--content mt_xxl"},ge={key:2,class:"row gutter_md"},ye={key:3,class:"row gutter_md"},xe={key:0,class:"flex_center mt_x50 mb_x50"},Re=Y({__name:"SeasonDetails",setup(be){const P=J(),n=m({}),o=m([]),v=m(1),f=m(20),y=m(0),l=m(!1),h=m(!1),T=K(),V=Z(),r=S(()=>{const{mid:e,type:i,season_id:g,series_id:u,name:s,cover:a}=T.query;return{mid:e,type:i,season_id:g,series_id:u,name:s,cover:a}}),L=S(()=>{let e="";return r.value.type==="season"?n.value.ptime&&(e=E(n.value.ptime*1e3)):n.value.mtime&&(e=E(n.value.mtime*1e3)),e||"--"}),q=S(()=>o.value.every(e=>e.isCheese));j(".season_details--scroller");const F=()=>P.flashPageCursors();ee(o,()=>P.flashPageCursors(200));const N=()=>{if(l.value)return;l.value=!0,h.value=!1;const{mid:e,type:i,season_id:g,series_id:u}=r.value;i==="season"?re({mid:e,season_id:g,reverse:!1,pn:v.value,ps:f.value}).then(s=>{var a;y.value=((a=s.page)==null?void 0:a.total)||0,n.value=s.meta||{},o.value=(s.archives||[]).map(x=>B(x)),l.value=!1}).catch(s=>{console.error(s),l.value=!1,h.value=!0}):Promise.all([ne(u),ie({mid:e,series_id:u,sort:"desc",pn:v.value,ps:f.value})]).then(([s,a])=>{var x;y.value=((x=a.page)==null?void 0:x.total)||0,n.value=s.meta||{},o.value=(a.archives||[]).map($=>B($)),l.value=!1}).catch(s=>{console.error(s),l.value=!1,h.value=!0})},I=()=>{v.value=1,o.value=[],A.emit("requestScrollToTop"),N()},W=()=>{o.value=[],A.emit("requestScrollToTop"),N()},M=()=>{setTimeout(()=>W(),200)},R=()=>{const{type:e}=r.value;oe({type:"ugc",fromSpmid:"main.space-seasons-series.0.0.pv",mediaList:{bizType:e==="season"?8:5,bizId:e==="season"?r.value.season_id:r.value.series_id,bizTitle:r.value.name}})};return ae(()=>{const{mid:e,type:i}=T.query;if(!e||!i){V.replace({name:"HomeRecommends"});return}I()}),(e,i)=>{const g=C("v-button"),u=C("bili-video-card"),s=C("v-pagenation");return t(),c("div",ce,[p(G,{class:"season_details--scroller page_scroller h_100",onScroll:F},{default:D(()=>[d("div",ue,[d("div",me,[_(r).cover?(t(),b(Q,{key:1,class:"season_details--header-card mr_sm",src:_(r).cover},null,8,["src"])):(t(),b(X,{key:0,class:"season_details--header-card mr_sm"})),d("div",_e,[d("h4",de,k(n.value.name||"--"),1),d("p",pe,k(_(r).type==="season"?"\u5408\u96C6 \xB7 ":"")+k(n.value.total||0)+"\u4E2A\u89C6\u9891 \xB7 "+k(_(L))+"\u66F4\u65B0 ",1),p(g,{class:"mt_md p_relative",type:"pink",disabled:!o.value.length||_(q),onClick:R},{default:D(()=>[p(_(O),{class:"mt_n2"}),ve,fe]),_:1},8,["disabled"])])]),d("div",he,[!h.value&&!l.value&&!o.value.length?(t(),b(U,{key:0})):h.value&&!l.value&&!o.value.length?(t(),b(H,{key:1})):l.value&&!o.value.length?(t(),c("div",ge,[(t(!0),c(w,null,z(f.value,a=>(t(),c("div",{class:"col_3 col_sm_1_5 mb_xxl",key:a},[p(u,{"img-lazy":"eager","disable-frame":"","disable-scale":"",skeleton:!0,scrollWrap:".season_details--scroller"})]))),128))])):(t(),c("div",ye,[(t(!0),c(w,null,z(o.value,a=>(t(),c("div",{class:"col_3 col_sm_1_5 mb_xxl",key:a.aid},[p(u,{info:a,"img-lazy":"eager","disable-frame":"","disable-scale":"",iid:"pc_app_space_seasons",scrollWrap:".season_details--scroller"},null,8,["info"])]))),128))]))]),y.value>f.value?(t(),c("div",xe,[p(s,{theme:"pink",pageNum:v.value,"onUpdate:pageNum":i[0]||(i[0]=a=>v.value=a),"page-size":f.value,total:y.value,"show-extend-btn":!1,"show-jump-info":!1,"btn-extra-render":_(le),onPageChange:M},null,8,["pageNum","page-size","total","btn-extra-render"])])):se("",!0)])]),_:1})])}}});export{Re as default};

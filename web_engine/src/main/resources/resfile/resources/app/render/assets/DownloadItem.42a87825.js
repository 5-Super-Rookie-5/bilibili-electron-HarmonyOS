import{I as i1,W as u1}from"./MoreFeedback.eac5fca1.js";import{o as i,c as u,a,M as d1,fh as c1,y as r1,x as m1,k as T,al as v1,A as _,d3 as O,P as p1,fi as P,aJ as g,t as x,Q as M,W as n,a0 as m,Z as k,U as p,ae as j,$ as f,X as Y,cM as f1,V as y,Y as h1,a2 as Q,fj as _1,cN as g1,ad as w1,aa as V,S as J,C as I1,a6 as C1,a7 as D1,ac as y1}from"./index.f074ecef.js";import{b as F1}from"./index.194c39d1.js";import{_ as B1}from"./plugin-vue_export-helper.21dcd24c.js";function E(s){return G(s)?E(s.itemList[0]):s}function p0(s,o){const h=[s];for(;h.length;){const v=h.shift();if(G(v)){if(v.groupId.toString()===o)return v;h.push(...v.itemList)}}return null}function G(s){return s&&"itemList"in s}function x1(s){const o=[s];let h=0;for(;o.length;){const v=o.shift();G(v)?o.push(...v.itemList):h++}return h}const k1={class:"mr_2",width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},E1=a("path",{d:"M13.667 9.917h.5a.5.5 0 0 0-.5-.5v.5Zm-11.334 0v-.5a.5.5 0 0 0-.5.5h.5Zm11.334-.5H2.333v1h11.334v-1Zm-11.834.5V12.6h1V9.917h-1Zm1.5 4.183h9.334v-1H3.333v1Zm10.834-1.5V9.917h-1V12.6h1Zm-1.5 1.5a1.5 1.5 0 0 0 1.5-1.5h-1a.5.5 0 0 1-.5.5v1ZM1.833 12.6a1.5 1.5 0 0 0 1.5 1.5v-1a.5.5 0 0 1-.5-.5h-1ZM11.258 12.466a.708.708 0 1 0 0-1.416.708.708 0 0 0 0 1.416Z"},null,-1),b1=a("path",{d:"m12.421 3.913-.49.102.49-.102ZM2.823 10.02l1.26-6.006-.978-.205-1.261 6.006.979.205Zm1.75-6.403h6.869v-1h-6.87v1Zm7.358.399 1.246 6.003.98-.203L12.91 3.81l-.98.204Zm-.49-.399a.5.5 0 0 1 .49.399l.98-.204a1.5 1.5 0 0 0-1.47-1.195v1Zm-7.358.397a.5.5 0 0 1 .49-.397v-1a1.5 1.5 0 0 0-1.468 1.192l.978.205Z"},null,-1),S1=[E1,b1];function $1(s,o){return i(),u("svg",k1,[...S1])}var L1={render:$1};const Z1={width:"50",height:"47",viewBox:"0 0 50 47",fill:"none",xmlns:"http://www.w3.org/2000/svg"},z1=a("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M49.455 16.794c.08.808.15 1.617.212 2.426.244 3.238.355 6.482.33 9.729-.012 1.626-.066 3.25-.155 4.875a99.068 99.068 0 0 1-.28 3.653l-.062.609-.033.304-.017.152a8.708 8.708 0 0 1-2.343 5.13 8.543 8.543 0 0 1-4.829 2.558l-.101.016c-.081.012-.161.025-.242.033l-.34.035-.6.05-1.199.092a189.129 189.129 0 0 1-7.198.398 205.775 205.775 0 0 1-19.214-.178c-1.6-.089-3.198-.202-4.797-.338l-.15-.012-.075-.006-.085-.009c-.115-.012-.23-.023-.345-.038l-.343-.053-.34-.067a8.63 8.63 0 0 1-6.545-6.52 8.713 8.713 0 0 1-.129-.686l-.043-.345-.032-.304a99.887 99.887 0 0 1-.298-3.65 107.377 107.377 0 0 1-.157-9.744c.092-3.245.319-6.481.667-9.707.1-.914.345-1.817.727-2.655a8.53 8.53 0 0 1 1.521-2.284 8.486 8.486 0 0 1 4.73-2.58c.226-.037.45-.07.677-.089l.169-.015.15-.01.3-.022 1.2-.079a191.143 191.143 0 0 1 5.545-.255l-.309-.39a79.062 79.062 0 0 1-1.585-2.131l-.385-.542-.19-.272-.014-.021a3.15 3.15 0 0 1-.167-.257 2.163 2.163 0 0 1-.245-1.466 2.613 2.613 0 0 1 2.873-2.11c.32.041.562.137.773.257.21.119.387.265.535.43.068.074.127.154.187.234l.02.027.198.265.392.537a75.887 75.887 0 0 1 1.522 2.178c.493.736.973 1.483 1.433 2.243.179.296.354.594.527.895a301.567 301.567 0 0 1 7.425-.007c.172-.298.347-.594.523-.888.46-.762.94-1.507 1.434-2.243a75.887 75.887 0 0 1 1.521-2.178l.392-.537.198-.265.02-.027c.06-.08.12-.16.187-.234.148-.165.325-.31.535-.43.212-.12.453-.216.773-.256 1.365-.17 2.614.767 2.874 2.109.06.318.043.58-.003.82a2.163 2.163 0 0 1-.242.646 2.93 2.93 0 0 1-.163.25l-.019.028-.19.272-.385.542a75.788 75.788 0 0 1-1.585 2.13 31.312 31.312 0 0 1-.298.377c.76.025 1.522.054 2.282.088 1.6.072 3.2.161 4.801.28l.075.005.084.009.17.017c.112.008.22.024.33.04l.01.002.17.025.168.032a8.49 8.49 0 0 1 1.642.483A8.582 8.582 0 0 1 49.2 14.61l.03.17.023.171.023.171.012.093.007.062.033.303c.045.404.087.809.127 1.213Zm-4.48 16.756c.086-1.57.136-3.131.148-4.638.023-3.104-.082-6.24-.315-9.315a120.78 120.78 0 0 0-.322-3.468l-.033-.303.003.027-.01-.087-.028-.21-.03-.163-.018-.08a3.666 3.666 0 0 0-2.732-2.758l-.062-.015-.155-.028-.163-.024-.173-.017-.067-.005a155.47 155.47 0 0 0-4.655-.272c-2.952-.13-6.029-.2-9.404-.215a570.01 570.01 0 0 0-1.703-.004c-2.819 0-5.349.03-7.744.096-1.603.04-3.181.098-4.681.17l-.385.02c-.614.032-1.289.066-1.939.108l-1.188.079-.385.027-.157.015a3.621 3.621 0 0 0-2.912 2.105 3.73 3.73 0 0 0-.311 1.136 118.847 118.847 0 0 0-.64 9.313c-.09 3.175-.04 6.302.148 9.295a85.293 85.293 0 0 0 .282 3.454l.025.242.028.219c.017.106.032.192.047.254l.006.034a3.739 3.739 0 0 0 2.256 2.63c.175.069.356.126.54.168l.178.035.17.027.177.019.221.018c1.524.13 3.09.24 4.659.328a203.81 203.81 0 0 0 11.24.318 202.36 202.36 0 0 0 12.199-.373l.088-.006c.695-.044 1.487-.094 2.243-.152l1.189-.093.533-.044.245-.025s.107-.015.147-.022a3.676 3.676 0 0 0 2.035-1.083l.015-.015a3.782 3.782 0 0 0 1.008-2.14l.01-.085.052-.474.058-.58.005-.052c.033-.364.066-.727.097-1.09.061-.759.116-1.534.16-2.3Zm-4.647-10.6c.188.1.372.2.565.315.675.397.787 1.127.538 1.904-.288.898-1.218 1.686-2.108 1.395l-.038-.011c-.182-.06-.377-.131-.567-.202l-.143-.054c-.142-.054-.285-.108-.427-.165l-.058-.023c-.17-.066-.34-.133-.509-.204-.19-.076-.378-.153-.565-.233-.188-.079-.376-.16-.563-.24-.188-.08-.375-.16-.564-.238l-1.128-.471c-.752-.311-1.507-.616-2.26-.917l-1.132-.445c-.188-.075-.377-.146-.566-.218-.188-.072-.377-.143-.565-.218l-.045-.018c-.784-.315-.815-1.295-.577-2.13.253-.889.967-1.49 1.848-1.234.407.118.817.239 1.22.369l.607.193.602.203c.801.276 1.595.566 2.38.872.347.131.69.27 1.032.41l.143.057.216.088c.318.13.635.26.95.398a27.324 27.324 0 0 1 1.714.817Zm-20.339-.042-.045.019c-.18.072-.363.141-.545.21-.195.075-.39.149-.585.227l-1.131.446c-.754.3-1.509.604-2.26.916l-1.129.471-.498.212c-.21.09-.418.179-.628.266-.187.08-.375.158-.566.234-.131.055-.264.108-.398.16l-.168.067a26.616 26.616 0 0 1-1.137.42l-.038.012c-.892.292-1.82-.498-2.109-1.396-.25-.78-.136-1.509.537-1.905a17.666 17.666 0 0 1 1.13-.602c.378-.185.762-.364 1.148-.53.338-.147.677-.286 1.017-.425l.15-.061a64.772 64.772 0 0 1 3.555-1.339l.602-.203.607-.194c.401-.13.811-.25 1.22-.368.881-.256 1.595.345 1.848 1.234.237.834.205 1.813-.577 2.13Zm11.597 5.663c-.395-.08-.751.097-.863.479l-.02.069-.033.118-.04.13a7.027 7.027 0 0 1-.295.787 4.96 4.96 0 0 1-.517.936c-.2.272-.417.504-.645.654-.23.15-.462.222-.722.227a1.783 1.783 0 0 1-.813-.168c-.265-.121-.517-.316-.759-.552a4.674 4.674 0 0 1-.655-.83 5.849 5.849 0 0 1-.403-.725l-.058-.123-.049-.108-.031-.069a.772.772 0 0 0-.719-.457h-.006a.773.773 0 0 0-.719.457l-.031.07-.049.107-.058.123c-.04.082-.08.165-.123.247-.087.163-.18.323-.28.478-.195.309-.415.593-.655.83-.242.236-.494.43-.759.552a1.774 1.774 0 0 1-.813.168 1.344 1.344 0 0 1-.722-.227c-.23-.15-.446-.382-.645-.654a4.953 4.953 0 0 1-.516-.935 6.447 6.447 0 0 1-.207-.521c-.027-.077-.052-.154-.076-.23l-.012-.036-.04-.131-.034-.118-.02-.069c-.11-.384-.466-.558-.863-.48-.418.083-.72.428-.638.85l.02.1.018.088.04.172a8.41 8.41 0 0 0 .307.992c.168.434.375.861.65 1.273.273.41.623.806 1.083 1.118a3.055 3.055 0 0 0 1.603.525 3.402 3.402 0 0 0 1.587-.343 4.2 4.2 0 0 0 1.232-.918c.28-.3.516-.619.723-.95.207.331.444.65.724.95.336.36.748.684 1.231.918.483.236 1.037.36 1.587.343.282-.008.57-.059.843-.15.274-.089.53-.22.76-.374.46-.313.81-.709 1.084-1.119a6.6 6.6 0 0 0 .65-1.273 8.652 8.652 0 0 0 .306-.992l.04-.172.019-.087.02-.101c.081-.424-.219-.767-.639-.85Z",fill:"#E3E5E7"},null,-1),A1=[z1];function T1(s,o){return i(),u("svg",Z1,[...A1])}var P1={render:T1};const b=s=>(C1("data-v-03246806"),s=s(),D1(),s),M1=["data-card"],V1={class:"scale-wrapper"},G1=["src"],N1=b(()=>a("div",{class:"tapper"},null,-1)),q1=["textContent"],U1=b(()=>a("div",{style:{flex:"1"}},null,-1)),H1=["textContent"],R1=["textContent"],W1={key:2,class:"hover-layer"},O1=b(()=>a("span",null,"\u524D\u5F80\u8BE6\u60C5\u9875",-1)),j1={class:"info"},Y1={class:"info-content"},J1=["textContent","title"],Q1={class:"info-option"},X1={class:"drop-down-list"},K1=["textContent","onClick"],e0=["textContent"],t0={key:1,class:"info-downloading"},o0=["textContent"],n0={class:"downloading-progress"},s0={class:"content-wrapper"},a0=b(()=>a("h4",{class:"b_text text1 text_center mt_md"},"\u786E\u8BA4\u5220\u9664\u8BE5\u7F13\u5B58\u9879\u5417\uFF1F",-1)),l0={class:"mt_xl text_center dialog_btns"},i0=Q("\u53D6\u6D88"),u0=Q("\u5220\u9664"),d0=d1({__name:"DownloadItem",props:{item:{type:Object,required:!0},isDownloaded:{type:Boolean,default:!0},isDownloadSearch:{type:Boolean,default:!1},isFirstCard:{type:Boolean,default:!1}},setup(s){const o=s;c1();const h=r1(),{userInfo:v}=m1(h),S=T(!1),N=y1(),q=v1(),C=_(()=>x1(o.item)),l=_(()=>C.value===1?E(o.item):o.item),D=_(()=>C.value>1),X=_(()=>{var t,c,r;const e=(c=(t=o.item)==null?void 0:t.itemList)==null?void 0:c[0];return e?e.type==="ogv":((r=o.item)==null?void 0:r.type)==="ogv"}),U=_(()=>{var t,c;const e=(c=(t=o.item)==null?void 0:t.itemList)==null?void 0:c[0];return e?e.type==="ogv"?O[e.seasonType]:"":o.item.type==="ogv"?O[o.item.seasonType]:""}),$=T("");let L=!1;const H=async()=>{L=!0;try{$.value=await _1(l.value.coverImg,g1(w1(l.value.coverUrl||"",512*N,288*N)))}finally{L=!1}};H(),p1(l,(e,t)=>{!L&&t.coverImg!==e.coverImg&&H()});const Z=()=>{const e=E(o.item),{type:t,aid:c,bvid:r,p:A,seasonId:B,epid:d}=e||{};V({type:t,aid:c,bvid:r,p:A,seasonId:B,epid:d,fromSpmid:J.mineDownload+".pv"})},w=T(!1),R=()=>{w.value=!0},K=()=>{w.value=!1,o.isDownloaded?o.item.itemList?g("download/deleteGroups",{groupIds:[o.item.groupId]}):g("download/deleteGroupItems",{groupId:o.item.groupId,itemIds:[o.item.itemId]}):g("download/deleteTasks",{taskIds:[o.item.itemId]})};let I=!1,F=-1;const W=400,e1=async e=>{if(!(I||Date.now()-F<W)){I=!0,F=Date.now();try{await g("download/pauseTasks",{taskIds:[e.itemId]})}finally{I=!1}}},t1=async e=>{if(!v.value.isLogin){I1("downloadItem.handleStart");return}if(!(I||Date.now()-F<W)){I=!0,F=Date.now();try{await g("download/restartTasks",{taskIds:[e.itemId]})}finally{I=!1}}},o1=e=>{q.push({name:"Space",query:{mid:e}})},n1=()=>{const e=E(o.item),t=e==null?void 0:e.itemId;t&&V({type:"ugc",fromSpmid:"main.mine-cache.0.0.pv",mediaList:{bizType:-1,bizId:t,bizTitle:"\u79BB\u7EBF\u7F13\u5B58"}})},z=e=>{if(!!o.isDownloaded){if(o.isDownloadSearch&&e.status!=="completed"){x({content:"\u89C6\u9891\u672A\u4E0B\u8F7D\u5B8C\u6210\uFF01"});return}if(D.value)q.push({name:"MineDownloadCollection",query:{openedGroupId:e.groupId}});else{if(e.status==="damaged"){x({content:"\u6587\u4EF6\u635F\u574F\uFF0C\u8BF7\u91CD\u65B0\u4E0B\u8F7D"});return}V({type:e.type,aid:e.aid,bvid:e.bvid,p:e.p,cid:e.cid,localCid:e.cid,seasonId:e.seasonId,epid:e.epid,fromSpmid:J.mineDownload+".pv",mediaList:{bizType:-1,bizId:e.itemId,bizTitle:"\u79BB\u7EBF\u7F13\u5B58"}})}}},s1=_(()=>{const e={connecting:"\u94FE\u63A5\u4E2D",downloading:o.item.totalSize?`\u7F13\u5B58\u4E2D\uFF1A${P(o.item.loadedSize||0)}/${P(o.item.totalSize)}`:"\u7F13\u5B58\u4E2D",pending:"\u7B49\u5F85\u4E0B\u8F7D",paused:"\u5DF2\u6682\u505C",completed:"\u5DF2\u5B8C\u6210",error:"\u4E0B\u8F7D\u9519\u8BEF",notAllowed:"\u4E0B\u8F7D\u9519\u8BEF",damaged:"\u6587\u4EF6\u635F\u574F"},{status:t,errorMsg:c}=o.item||{};let r=e[t];return t==="error"&&c&&(r=`${r}\uFF08${c}\uFF09`),r}),a1=_(()=>o.isDownloaded?[...C.value<=1?[{text:"\u66F4\u65B0\u5F39\u5E55",handler:()=>{let e=null;o.item.itemList?e=Promise.all(o.item.itemList.map(t=>g("download/updateItemDmInfo",{itemId:t.itemId}))):e=g("download/updateItemDmInfo",{itemId:o.item.itemId}),e==null||e.then(()=>x({content:"\u5DF2\u66F4\u65B0\u5F39\u5E55\u6570\u636E"})).catch(t=>{console.error(t),x({content:"\u66F4\u65B0\u5F39\u5E55\u5931\u8D25"})})}}]:[],{text:C.value>1?"\u64AD\u653E\u5168\u90E8":"\u64AD\u653E",handler:n1},{text:"\u5728\u7EBF\u8BE6\u60C5\u9875",handler:Z},{text:"\u5220\u9664",handler:R}]:[{text:"\u5728\u7EBF\u8BE6\u60C5\u9875",handler:Z},{text:"\u5220\u9664",handler:R}]);return(e,t)=>{var B;const c=M("v-dropdown"),r=M("v-button"),A=M("v-dialog");return i(),u("div",{class:k(["download-item",{"not-collection":!n(D)}])},[a("span",{class:"gamepad-cursor cursor-video-card","data-scroll":"y","data-bf":"100","data-sh":"300","data-wp":".app_mine--content","data-tp":"videoCard","data-card":s.isFirstCard},null,8,M1),a("div",V1,[n(D)?(i(),u("div",{key:0,class:"collection",onClick:t[0]||(t[0]=d=>z(n(l)))})):m("",!0),a("div",{class:k(["cover",{clickable:s.isDownloaded,"transp-bg":S.value}]),onClick:t[4]||(t[4]=d=>z(n(l)))},[p(n(P1),{class:"cover-ph"}),$.value?(i(),u("img",{key:0,src:$.value,loading:"lazy",style:j({backgroundColor:S.value?"transparent":""}),onLoad:t[1]||(t[1]=d=>S.value=!0),onerror:"this.remove()"},null,44,G1)):m("",!0),(!s.isDownloaded||((B=o.item.itemList)==null?void 0:B.length))&&n(U)?(i(),u("div",{key:1,class:k(["badge",{"hide-on-hover":!s.isDownloaded}])},f(n(U)),3)):m("",!0),N1,a("div",{class:k(["cover-info",{"hide-on-hover":!s.isDownloaded}])},[n(l).totalSize?(i(),u(Y,{key:0},[p(n(L1)),a("div",{class:"size",textContent:f(n(P)(n(l).totalSize))},null,8,q1)],64)):m("",!0),U1,n(D)?m("",!0):(i(),u("div",{key:1,class:"duration",textContent:f(n(f1)(Math.round(n(l).duration)))},null,8,H1)),n(D)?(i(),u("div",{key:2,class:"collection-count",textContent:f(`${n(C)||1}\u4E2A\u5185\u5BB9`)},null,8,R1)):m("",!0)],2),s.isDownloaded?m("",!0):(i(),u("div",W1,[a("div",{class:"to-detail",onClick:Z},[O1,p(n(F1))]),["connecting","downloading","pending"].includes(n(l).status)?(i(),u("div",{key:0,class:"control-button",onClick:t[2]||(t[2]=d=>e1(n(l)))}," \u6682\u505C\u7F13\u5B58 ")):m("",!0),["paused","error","damaged","notAllowed"].includes(n(l).status)?(i(),u("div",{key:1,class:"control-button",onClick:t[3]||(t[3]=d=>t1(n(l)))},f(n(l).status==="paused"?"\u5F00\u59CB\u7F13\u5B58":"\u91CD\u65B0\u4E0B\u8F7D"),1)):m("",!0)]))],2)]),a("div",j1,[a("div",Y1,[a("div",{class:"info-title fw_500",textContent:f(n(l).title),title:n(l).title,onClick:t[5]||(t[5]=d=>z(n(l)))},null,8,J1)]),p(c,{trigger:"click","click-hide":""},{content:y(()=>[a("div",X1,[(i(!0),u(Y,null,h1(n(a1),(d,l1)=>(i(),u("div",{class:"option",key:l1,textContent:f(d.text),onClick:d.handler},null,8,K1))),128))])]),default:y(()=>[a("div",Q1,[p(n(i1))])]),_:1})]),s.isDownloaded&&n(l).uname&&!n(X)?(i(),u("div",{key:0,class:"info-up",onClick:t[6]||(t[6]=d=>o1(n(l).uid))},[p(n(u1),{class:"up-icon"}),a("span",{class:"up-name",textContent:f(n(l).uname)},null,8,e0)])):m("",!0),s.isDownloaded?m("",!0):(i(),u("div",t0,[a("div",{class:"downloading-text",textContent:f(n(s1))},null,8,o0),a("div",n0,[a("div",{class:"progress-percent",style:j({width:`${n(l).progress}%`})},null,4)])])),p(A,{visible:w.value,"onUpdate:visible":t[8]||(t[8]=d=>w.value=d),width:320,"class-name":"i_dialog py_lg",onCancel:t[9]||(t[9]=d=>w.value=!1),"is-show-default-footer":!1},{default:y(()=>[a("div",s0,[a0,a("div",l0,[p(r,{class:"mr_sm",onClick:t[7]||(t[7]=d=>w.value=!1)},{default:y(()=>[i0]),_:1}),p(r,{type:"danger",onClick:K},{default:y(()=>[u0]),_:1})])])]),_:1},8,["visible"])],2)}}});var f0=B1(d0,[["__scopeId","data-v-03246806"]]);export{f0 as D,P1 as P,p0 as a,x1 as b,E as g,G as i};
